name       : file
version    : '5.32'
release    : 16
source     :
    - ftp://ftp.astron.com/pub/file/file-5.32.tar.gz : 8639dc4d1b21e232285cd483604afc4a6ee810710e00e579dbe9591681722b50
homepage   : http://www.darwinsys.com/file
license    : BSD-2-Clause
component  : system.base
devel      : yes
summary    : file (file type guesser)
description: |
    file is a command used to guess the "file type" of a file.  It reads the content to determine the data.
setup      : |
    %patch -p0 < $pkgfiles/change-dest-for-mgc-file.patch
    %patch -p1 < $pkgfiles/security/cve-2018-10360.patch
    %configure --disable-static \
               --enable-shared
build      : |
    %make
install    : |
    %make_install
check      : |
    %make check

    # If these don't pass, ypkg will create very broken packages
    TEST1=`file /usr/lib64/libc-2.27.so | grep "ELF 64-bit LSB shared object" | wc -l`
    TEST2=`file /usr/bin/file | grep "ELF 64-bit LSB executable" | wc -l`
    if [ $TEST1 -eq 0 ]; then
        echo "Failed TEST1"
        failtestungracefully
    fi
    if [ $TEST2 -eq 0 ]; then
        echo "Failed TEST2"
        failtestungracefully
    fi
